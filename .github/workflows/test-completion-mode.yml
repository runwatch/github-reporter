name: Test Completion Mode

on:
  workflow_run:
    workflows: ["Test Inline Mode"]
    types:
      - completed
      - requested

permissions:
  actions: read
  contents: read

jobs:
  report-on-completion:
    runs-on: ubuntu-latest
    if: github.event.workflow_run.event == 'workflow_dispatch' || github.event.workflow_run.event == 'push'
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      
      - name: Report metrics for completed workflow (dry run)
        uses: ./
        with:
          workflow_run_id: ${{ github.event.workflow_run.id }}
          api_key: 'dummy-key-for-testing'
          dry_run: 'true'

